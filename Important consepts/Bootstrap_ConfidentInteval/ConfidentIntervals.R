##EXAMPLE 7 p31:
#DATA
x <- c(2.1515841947629, 1.12687223865791, 0.450539957801455, 0.612649953344725, 
       8.81302614365099, 0.482044442321381, 0.684854830116726, 1.91373301851339, 
       0.414108851469476, 2.73720235504962, 1.40997463412646, 0.519265098505481, 
       1.60452133192737, 0.681669263493296, 2.83211613252523, 0.86794695251854, 
       0.982569898771445, 0.265595393497361, 1.72603520782446, 0.779635136736261, 
       1.56381604587928, 1.20688040620751, 0.615521199763738, 0.406758416651894, 
       0.114253382121742, 1.00515391989458, 2.06528976681373, 0.950134214861709, 
       0.501126829627956, 0.287111736499692, 0.515302160852769, 0.768866540743837, 
       1.71308706457317, 0.441581913426794, 0.995844800114274, 2.7566243025192, 
       0.73784027201879, 0.628065260346355, 1.45347331254509, 2.23647299992199, 
       0.484674138773892, 0.914943424235289, 1.50352298904134, 0.761519350072525, 
       0.977494295866494, 0.766397471905748, 0.713002224130612, 5.24126176496795, 
       1.2052276955735, 0.249154492009284, 0.653795053410932, 0.923751432198942, 
       0.853780565905928, 0.681721607570563, 1.20916342865606, 0.584912844986508, 
       1.05376906815525, 1.04838048165939, 1.3639852788365, 0.781525132321568, 
       1.11893838516444, 1.2059139301614, 1.49167648179161, 1.85953586493907, 
       0.722415266571323, 0.408327134006335, 1.76612748762178, 2.23984493489865, 
       2.4537409277851, 1.31565845419726, 1.86358394414171, 2.10815415969246, 
       2.47822363548838, 0.703328236381487, 0.718983245153106, 0.511055502687867, 
       0.375364996655719, 0.600670323610726, 0.601610139365746, 0.535321539175598, 
       1.16710142827028, 0.858435206677491, 0.447702380408224, 1.06553205294884, 
       1.14244477372062, 1.99960207857627, 0.63506087131869, 1.05902627162453, 
       1.67608037216048, 1.13916245267107, 1.14250513896218, 0.129638672942295, 
       0.376536846178602, 0.286943320500181, 1.4079180701742, 0.802353577930748, 
       0.490292677312944, 0.560042343452032, 2.81845649548964, 1.57880035624666, 
       3.46761868907154, 0.772103176743021, 1.69055401282719, 0.933396017665226, 
       0.500617850006273, 0.528735844999741, 1.63348169650271, 1.45830145793522, 
       0.617702274695232, 0.842578035066825, 0.419667852428402, 0.498534340788081, 
       0.826319345766062, 0.65189037232075, 0.577577734039332, 2.01251026441609
)

BootCI <- function(X, B, alpha){
  vec <- c()
  for(i in 1:B){
    Xstar <- sample(X, replace = TRUE)
    CV <- sd(Xstar)/mean(Xstar)
    vec <- c(vec, CV)
  }
  vec <- sort(vec)
  r <- floor(B*alpha/2)
  s <- floor(B*(1-alpha/2))
  lower <- 2*median(X) - vec[s]
  upper <- 2*median(X) - vec[r]
  
  return(c(lower,upper))
}

BootCIHYB <-  function(X, B, alpha){
  vec <- c()
  for(i in 1:B){
    Xstar <- sample(X, replace = TRUE)
    med <- median(Xstar)
    vec <- c(vec, med)
  }
  vec <- sort(vec)
  r <- floor(B*alpha/2)
  s <- floor(B*(1-alpha/2))
  lower <- 2*median(X) - vec[s]
  upper <- 2*median(X) - vec[r]
  
  return(c(lower,upper))
}

BootCI(x, 10000, 0.05)
BootCIHYB(x, 10000, 0.05)